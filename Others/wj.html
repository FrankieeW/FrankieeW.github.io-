<!DOCTYPE html>
  <html lang="zh-CN">
  <head>
    <meta charset="UTF-8">
    <title>大学生人生观与人生理想调查问卷</title>
    <!-- 引入jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- 引入Google客户端API库 -->
    <script async defer src="https://apis.google.com/js/api.js"></script>
  </head>
  <body>

<h1>大学生人生观与人生理想调查问卷</h1>
<p>尊敬的同学们：<br>您好！本问卷旨在了解当前大学生的人生观和人生理想。您的真实回答将对我们的研究提供重要数据。请您根据自身情况，认真、客观地选择或填写。本调查保证您的个人信息及答案的匿名性和保密性，请放心填写。</p>

<form id="surveyForm">

  <h2>基本信息</h2>

  <p>1. 性别：</p>
  <label><input type="radio" name="gender" value="male"> 男</label>
  <label><input type="radio" name="gender" value="female"> 女</label>

  <p>2. 年级：</p>
  <label><input type="radio" name="grade" value="freshman"> 大一</label>
  <label><input type="radio" name="grade" value="sophomore"> 大二</label>
  <label><input type="radio" name="grade" value="junior"> 大三</label>
  <label><input type="radio" name="grade" value="senior"> 大四</label>

  <p>3. 学院（可填写具体名称）：</p>
  <input type="text" name="college">

  <p>4. 专业：</p>
  <input type="text" name="major">

  <h2>人生观部分</h2>

  <p>5. 您认为人生最重要的是什么？</p>
  <label><input type="checkbox" name="life_importance" value="personal_happiness"> 个人幸福</label>
  <label><input type="checkbox" name="life_importance" value="family_harmony"> 家庭和睦</label>
  <label><input type="checkbox" name="life_importance" value="career_success"> 职业成功</label>
  <label><input type="checkbox" name="life_importance" value="social_recognition"> 社会认可</label>
  <label><input type="checkbox" name="life_importance" value="personal_growth"> 个人成长与自我实现</label>
  <label>其他（请具体说明）<input type="text" name="life_importance_other"></label>

  <p>6. 您如何看待个人的成功？</p>
  <label><input type="checkbox" name="personal_success" value="high_income"> 赚取高收入</label>
  <label><input type="checkbox" name="personal_success" value="high_education"> 拥有高学历/高职称</label>
  <label><input type="checkbox" name="personal_success" value="social_status"> 取得社会地位和名誉</label>
  <label><input type="checkbox" name="personal_success" value="social_contribution"> 对社会有所贡献</label>
  <label><input type="checkbox" name="personal_success" value="personal_interests"> 个人兴趣和爱好的实现</label>
  <label>其他（请具体说明）<input type="text" name="personal_success_other"></label>

  <p>7. 您如何定义幸福？</p>
  <textarea name="definition_of_happiness" rows="3" cols="50"></textarea>

  <p>8. 在遇到人生挫折时，您通常如何应对？</p>
  <textarea name="coping_with_setbacks" rows="3" cols="50"></textarea>

  <p>9. 您认为人生的价值主要体现在什么方面？</p>
  <textarea name="value_of_life" rows="3" cols="50"></textarea>

  <h2>人生理想部分</h2>

  <p>10. 您的人生理想是什么？</p>
  <label><input type="checkbox" name="life_ideal" value="field_expert"> 成为某个领域的专家</label>
  <label><input type="checkbox" name="life_ideal" value="successful_entrepreneur"> 创业并取得成功</label>
  <label><input type="checkbox" name="life_ideal" value="social_contribution"> 为社会福利事业做出贡献</label>
  <label><input type="checkbox" name="life_ideal" value="continuous_growth"> 保持持续的个人成长和学习</label>
  <label><input type="checkbox" name="life_ideal" value="happy_family_life"> 拥有幸福的家庭生活</label>
  <label>其他（请具体说明）<input type="text" name="life_ideal_other"></label>

  <p>11. 您认为实现人生理想的关键因素是什么？</p>
  <textarea name="key_to_life_ideal" rows="3" cols="50"></textarea>

  <p>12. 请描述一下您未来五年的规划。</p>
  <textarea name="five_year_plan" rows="3" cols="50"></textarea>

  <p>13. 您认为现代社会给年轻人实现人生理想提供了哪些机遇和挑战？</p>
  <textarea name="opportunities_challenges" rows="3" cols="50"></textarea>

  <p><input type="button" id="submitButton" value="提交问卷"></p>
</form>

<script>
  // 为按钮点击事件添加事件监听器
  $('#submitButton').click(function(e) {
    e.preventDefault(); // 阻止表单的默认提交行为

    // 从表单元素中收集数据
    var formData = $('#surveyForm').serializeArray();

    // 处理表单数据并发送到SheetDB
    handleFormSubmit(formData);
  });

  function handleFormSubmit(formData) {
    // 将formData转换为一个JavaScript对象，以便更容易处理
    var data = {};
    formData.forEach(function(item) {
      // 检查数据是否为复选框
      if ($('input[name="' + item.name + '"][type="checkbox"]').length) {
        if (data[item.name]) {
          // 如果已经存在，则添加到该项的字符串，并用逗号分隔
          data[item.name] += ', ' + item.value;
        } else {
          // 如果不存在，则开始一个新的字符串
          data[item.name] = item.value;
        }
      } else {
        // 如果不是复选框，直接赋值
        data[item.name] = item.value;
      }
    });
    var dataToSend = [data];
    console.log(JSON.stringify(dataToSend));
    // 发送POST请求到SheetDB API
    $.ajax({
      url: 'https://sheetdb.io/api/v1/zr9hecyorxhn3', // 替换为你的SheetDB API端点
      type: 'POST',
      contentType: 'application/json', // 确保设置正确的内容类型
      data: JSON.stringify(dataToSend), // 确保发送的是JSON字符串
      dataType: 'json',
      success: function(response) {
        alert("问卷已成功提交！");
        console.log(response);
        // 可以在这里添加更多的成功提交后的操作，比如清空表单或者跳转到感谢页面
      },
      error: function(xhr, status, error) {
        // 打印错误信息
        console.error("Status: " + status);
        console.error("Error: " + error);
        console.error("Response: ", xhr.responseText);

        alert("提交问卷时出现错误：" + xhr.responseText);
      }
    });
  }

</script>


  </body>
</html>
